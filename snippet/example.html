<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Example</title>
    <script src="./console-override.js"></script>
    <script src="https://cdn.voicepanel.com/s/eM4lNuMhxuudVT7i7E.js"></script>
  </head>
  <body>
    <p>Hello world!</p>
    <button id="show">Show Survey</button>
    <button id="hide">Hide Survey</button>
    <button id="clear">Clear Storage</button>
    <button id="reload">Reload</button>
    <pre id="storage-display"></pre>
    <pre id="config-display"></pre>
    <script>
      document.getElementById("clear").onclick = function() {
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (key && key.startsWith('_vp')) {
            localStorage.removeItem(key);
            i--; // Adjust index after removing item
          }
        }
        window.location.reload();
      };
    </script>
    <script>
      document.getElementById("show").onclick = function() {
        const voicepanel = Voicepanel.init();
        voicepanel.showSurvey("csat_survey");
      };
    </script>
    <script>
      document.getElementById("hide").onclick = function() {
        const voicepanel = Voicepanel.init();
        voicepanel.hideSurvey("csat_survey");
      };
    </script>
    <script>
      document.getElementById("reload").onclick = function() {
        window.location.reload();
      };
    </script>
    <script>
      var configJson = JSON.stringify(window.voicepanelConfig || {}, null, 2);

      document.getElementById("config-display").innerHTML = `config: ${configJson}`;

      var storageOutput = '';
      for (var i = 0; i < localStorage.length; i++) {
        var key = localStorage.key(i);

        if (key.startsWith('_vp')) {
          var rawValue = localStorage.getItem(key);
          var value;

          try {
            var jsonValue = JSON.parse(rawValue);
            value = JSON.stringify(jsonValue, null, 2);
          } catch (e) {
            value = rawValue;
          }
        storageOutput += key + ': ' + value + '\n';
        }
      }

      document.getElementById("storage-display").innerHTML = storageOutput;
    </script>
  </body>
</html>
